---
title: "Crime-Category-Encoded"
author: "vaibhavi"
date: "March 4, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading the data

```{r}
setwd("~/Projects/Detroit Project")
crime=read.csv("crimewithzips.csv")
```

## Keeping relevant data

```{r}
colnames(crime)
drops=c("X","CASEID", "ADDRESS", "SCA", "CENSUSTRACT")

crime = crime[, !names(crime) %in% drops]
colnames(crime)
```


## Adding category-specific crime  columns
Top 15 crime categories are:
ASSAULT
LARCENY
BURGLARY
DAMAGE TO PROPERTY
STOLEN VEHICLE

AGGRAVATED ASSAULT
MURDER/INFORMATION
TRAFFIC
FRAUD
ROBBERY

DANGEROUS DRUGS
WEAPONS OFFENSES
ESCAPE
OBSTRUCTING JUDICIARY
DISORDERLY CONDUCT

NUM_CRIMES column must be added as well

```{r}
crime$NUM_CRIMES = 1

crime$NUM_ASSAULT <- ifelse(crime$CATEGORY == "ASSAULT", 1, 0)
crime$NUM_LARCENY <- ifelse(crime$CATEGORY == "LARCENY", 1, 0)
crime$NUM_BURGLARY <- ifelse(crime$CATEGORY == "BURGLARY", 1, 0)
crime$NUM_PROPERTY <- ifelse(crime$CATEGORY == "DAMAGE TO PROPERTY", 1, 0)
crime$NUM_AUTOTHEFT <- ifelse(crime$CATEGORY == "STOLEN VEHICLE", 1, 0)

crime$NUM_AGG_ASSAULT <- ifelse(crime$CATEGORY == "AGGRAVATED ASSAULT", 1, 0)
crime$NUM_MURDER <- ifelse(crime$CATEGORY =="MURDER/INFORMATION", 1, 0)
crime$NUM_TRAFFIC <- ifelse(crime$CATEGORY == "TRAFFIC", 1, 0)
crime$NUM_FRAUD <- ifelse(crime$CATEGORY == "FRAUD", 1, 0)
crime$NUM_ROBBERY <- ifelse(crime$CATEGORY == "ROBBERY", 1, 0)

crime$NUM_DRUGS <- ifelse(crime$CATEGORY == "DANGEROUS DRUGS", 1, 0)
crime$NUM_WEAPONS <- ifelse(crime$CATEGORY == "WEAPONS OFFENSES", 1, 0)
crime$NUM_ESCAPE <- ifelse(crime$CATEGORY == "ESCAPE", 1, 0)
crime$NUM_OBSTRUCT <- ifelse(crime$CATEGORY == "OBSTRUCTING JUDICIARY", 1, 0)
crime$NUM_CONDUCT <- ifelse(crime$CATEGORY == "DISORDERLY CONDUCT", 1, 0)

```
## Aggregate the data

```{r}
head(crime)


```



## Sanity Check

```{r}
head(crime)
colnames(crime)
drops = c("ROWNUM", "CATEGORY", "OFFENSEDESCRIPTION", "INCIDENTDATE","HOUR","PRECINCT","COUNCIL","NEIGHBORHOOD","LON","LAT", "LOCATION", "MONTH", "FINALZIP")
backup = crime[ , ! names(crime) %in% drops]

colnames(backup)
head(backup)
backup = aggregate(backup, by=list(backup$YEAR, backup$ZIP_CHAR), FUN=sum)

head(backup)
backup$YEAR <- NULL
backup$ZIP_CHAR <-NULL
library(data.table)
setnames(backup, old = c('Group.1','Group.2'), new = c('YEAR','ZIP_CHAR'))
backup

```


## Plotting Data

```{r}
library(ggplot2)
#ggplot(backup, aes(YEAR,value, col=variable)) + 
 # geom_point() + 
  #stat_smooth() 
```



## Saving the data

```{r}
write.csv(backup, "encodedcrimezips.csv")
```
